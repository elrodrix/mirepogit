<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Barras Chart</title>
	 <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
        <script> 
        var nandemonaiya = [
    [
        {
            "candidato": "Esteban Bullrich / Cambiemos ",
            "intencionDeVoto": 31.8,
            "encuestadora": "Rouvier & Asociados",
            "fechaDeLaEncuesta": 42936
        },
        {
            "candidato": "Cristina Kirchner / Unidad Ciudadana",
            "intencionDeVoto": 35.1,
            "encuestadora": "Rouvier & Asociados",
            "fechaDeLaEncuesta": 42936
        },
        {
            "candidato": "Sergio Massa / 1 país",
            "intencionDeVoto": 13.7,
            "encuestadora": "Rouvier & Asociados",
            "fechaDeLaEncuesta": 42936
        },
        {
            "candidato": "Florencio Randazzo / PJ",
            "intencionDeVoto": 9.7,
            "encuestadora": "Rouvier & Asociados",
            "fechaDeLaEncuesta": 42936
        },
        {
            "candidato": "Néstor Pitrola / FIT",
            "intencionDeVoto": 2.5,
            "encuestadora": "Rouvier & Asociados",
            "fechaDeLaEncuesta": 42936
        },
        {
            "candidato": "Pino Solanas / Creo",
            "intencionDeVoto": 0.8,
            "encuestadora": "Rouvier & Asociados",
            "fechaDeLaEncuesta": 42936
        }
    ],
    [
        {
            "candidato": "Esteban Bullrich / Cambiemos ",
            "intencionDeVoto": 24.8,
            "encuestadora": "Analogías",
            "fechaDeLaEncuesta": 42932
        },
        {
            "candidato": "Cristina Kirchner / Unidad Ciudadana",
            "intencionDeVoto": 34.7,
            "encuestadora": "Analogías",
            "fechaDeLaEncuesta": 42932
        },
        {
            "candidato": "Sergio Massa / 1 país",
            "intencionDeVoto": 16.2,
            "encuestadora": "Analogías",
            "fechaDeLaEncuesta": 42932
        },
        {
            "candidato": "Florencio Randazzo / PJ",
            "intencionDeVoto": 5,
            "encuestadora": "Analogías",
            "fechaDeLaEncuesta": 42932
        },
        {
            "candidato": "Néstor Pitrola / FIT",
            "intencionDeVoto": 1,
            "encuestadora": "Analogías",
            "fechaDeLaEncuesta": 42932
        },
        {
            "candidato": "Pino Solanas / Creo",
            "intencionDeVoto": 1,
            "encuestadora": "Analogías",
            "fechaDeLaEncuesta": 42932
        }
    ],
    [
        {
            "candidato": "Esteban Bullrich / Cambiemos ",
            "intencionDeVoto": 31.5,
            "encuestadora": "Opolit",
            "fechaDeLaEncuesta": 42931
        },
        {
            "candidato": "Cristina Kirchner / Unidad Ciudadana",
            "intencionDeVoto": 33.5,
            "encuestadora": "Opolit",
            "fechaDeLaEncuesta": 42931
        },
        {
            "candidato": "Sergio Massa / 1 país",
            "intencionDeVoto": 20.3,
            "encuestadora": "Opolit",
            "fechaDeLaEncuesta": 42931
        },
        {
            "candidato": "Florencio Randazzo / PJ",
            "intencionDeVoto": 6,
            "encuestadora": "Opolit",
            "fechaDeLaEncuesta": 42931
        },
        {
            "candidato": "Néstor Pitrola / FIT",
            "intencionDeVoto": 2,
            "encuestadora": "Opolit",
            "fechaDeLaEncuesta": 42931
        }
    ],
    [
        {
            "candidato": "Esteban Bullrich / Cambiemos ",
            "intencionDeVoto": 17.5,
            "encuestadora": "OPSM",
            "fechaDeLaEncuesta": 42931
        },
        {
            "candidato": "Cristina Kirchner / Unidad Ciudadana",
            "intencionDeVoto": 33.4,
            "encuestadora": "OPSM",
            "fechaDeLaEncuesta": 42931
        },
        {
            "candidato": "Sergio Massa / 1 país",
            "intencionDeVoto": 19.4,
            "encuestadora": "OPSM",
            "fechaDeLaEncuesta": 42931
        },
        {
            "candidato": "Florencio Randazzo / PJ",
            "intencionDeVoto": 7.4,
            "encuestadora": "OPSM",
            "fechaDeLaEncuesta": 42931
        },
        {
            "candidato": "Néstor Pitrola / FIT",
            "intencionDeVoto": 1.8,
            "encuestadora": "OPSM",
            "fechaDeLaEncuesta": 42931
        },
        {
            "candidato": "Pino Solanas / Creo",
            "intencionDeVoto": 1.4,
            "encuestadora": "OPSM",
            "fechaDeLaEncuesta": 42931
        }
    ],
    [
        {
            "candidato": "Esteban Bullrich / Cambiemos ",
            "intencionDeVoto": 39.41,
            "encuestadora": "CIGP",
            "fechaDeLaEncuesta": 42920
        },
        {
            "candidato": "Cristina Kirchner / Unidad Ciudadana",
            "intencionDeVoto": 37.35,
            "encuestadora": "CIGP",
            "fechaDeLaEncuesta": 42920
        },
        {
            "candidato": "Sergio Massa / 1 país",
            "intencionDeVoto": 11.29,
            "encuestadora": "CIGP",
            "fechaDeLaEncuesta": 42920
        },
        {
            "candidato": "Florencio Randazzo / PJ",
            "intencionDeVoto": 4.78,
            "encuestadora": "CIGP",
            "fechaDeLaEncuesta": 42920
        },
        {
            "candidato": "Néstor Pitrola / FIT",
            "intencionDeVoto": 1.95,
            "encuestadora": "CIGP",
            "fechaDeLaEncuesta": 42920
        }
    ],
    [
        {
            "candidato": "Esteban Bullrich / Cambiemos ",
            "intencionDeVoto": 33.2,
            "encuestadora": "Taquion",
            "fechaDeLaEncuesta": 42918
        },
        {
            "candidato": "Cristina Kirchner / Unidad Ciudadana",
            "intencionDeVoto": 34.8,
            "encuestadora": "Taquion",
            "fechaDeLaEncuesta": 42918
        },
        {
            "candidato": "Sergio Massa / 1 país",
            "intencionDeVoto": 17.7,
            "encuestadora": "Taquion",
            "fechaDeLaEncuesta": 42918
        },
        {
            "candidato": "Florencio Randazzo / PJ",
            "intencionDeVoto": 4.6,
            "encuestadora": "Taquion",
            "fechaDeLaEncuesta": 42918
        },
        {
            "candidato": "Néstor Pitrola / FIT",
            "intencionDeVoto": 2.2,
            "encuestadora": "Taquion",
            "fechaDeLaEncuesta": 42918
        }
    ],
    [
        {
            "candidato": "Esteban Bullrich / Cambiemos ",
            "intencionDeVoto": 26.1,
            "encuestadora": "González y Valladares",
            "fechaDeLaEncuesta": 42917
        },
        {
            "candidato": "Cristina Kirchner / Unidad Ciudadana",
            "intencionDeVoto": 29.7,
            "encuestadora": "González y Valladares",
            "fechaDeLaEncuesta": 42917
        },
        {
            "candidato": "Sergio Massa / 1 país",
            "intencionDeVoto": 24.1,
            "encuestadora": "González y Valladares",
            "fechaDeLaEncuesta": 42917
        },
        {
            "candidato": "Florencio Randazzo / PJ",
            "intencionDeVoto": 5.2,
            "encuestadora": "González y Valladares",
            "fechaDeLaEncuesta": 42917
        },
        {
            "candidato": "Néstor Pitrola / FIT",
            "intencionDeVoto": 1.8,
            "encuestadora": "González y Valladares",
            "fechaDeLaEncuesta": 42917
        }
    ],
    [
        {
            "candidato": "Esteban Bullrich / Cambiemos ",
            "intencionDeVoto": 28.5,
            "encuestadora": "Management & Fit",
            "fechaDeLaEncuesta": 42916
        },
        {
            "candidato": "Cristina Kirchner / Unidad Ciudadana",
            "intencionDeVoto": 27.8,
            "encuestadora": "Management & Fit",
            "fechaDeLaEncuesta": 42916
        },
        {
            "candidato": "Sergio Massa / 1 país",
            "intencionDeVoto": 24.1,
            "encuestadora": "Management & Fit",
            "fechaDeLaEncuesta": 42916
        },
        {
            "candidato": "Florencio Randazzo / PJ",
            "intencionDeVoto": 5.4,
            "encuestadora": "Management & Fit",
            "fechaDeLaEncuesta": 42916
        },
        {
            "candidato": "Néstor Pitrola / FIT",
            "intencionDeVoto": 3.1,
            "encuestadora": "Management & Fit",
            "fechaDeLaEncuesta": 42916
        }
    ],
    [
        {
            "candidato": "Esteban Bullrich / Cambiemos ",
            "intencionDeVoto": 34.3,
            "encuestadora": "Query",
            "fechaDeLaEncuesta": 42914
        },
        {
            "candidato": "Cristina Kirchner / Unidad Ciudadana",
            "intencionDeVoto": 34.8,
            "encuestadora": "Query",
            "fechaDeLaEncuesta": 42914
        },
        {
            "candidato": "Sergio Massa / 1 país",
            "intencionDeVoto": 15.6,
            "encuestadora": "Query",
            "fechaDeLaEncuesta": 42914
        },
        {
            "candidato": "Florencio Randazzo / PJ",
            "intencionDeVoto": 4.6,
            "encuestadora": "Query",
            "fechaDeLaEncuesta": 42914
        },
        {
            "candidato": "Néstor Pitrola / FIT",
            "intencionDeVoto": 3.3,
            "encuestadora": "Query",
            "fechaDeLaEncuesta": 42914
        }
    ]
]
        
    </script>
    <script src="../../dist/Chart.bundle.js"></script>
    <script src="../utils.js"></script>
	
	<link rel="stylesheet" type="text/css" href="styles-graph.css" />
	<link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,700" rel="stylesheet"/>
   <script src="https://code.jquery.com/jquery-3.2.0.min.js"></script>
    <script src="script.js"></script>
</head>

<body>
	<div class="content-graph">
		<div class="header-graph">
			<div class="btn-menu">
				<span class="line-btn"></span>
				<span class="line-btn"></span>
				<span class="line-btn"></span>
			</div>
			<h2 class="title-graph">Sondeos Elecciones 2017</h2>
			<div class="content-btn-graph" id="datosgrafico">
			</div>
		</div>
		<div class="content-data">
			<h2 class="tit-cons"></h2>
			<ul class="referencias" id="referencias">
			</ul>
		</div>
		<div id="canvas-holder">
			<canvas id="chart-area" />
		</div>
	</div>
	
	                <script>
                    var loopcount = 0;
                    for (var hoja of nandemonaiya) {
                        var encuestadora = hoja[0].encuestadora;
                        $("#datosgrafico").append("<button class='btn-graph' id='" + loopcount + "'>" + encuestadora + "</button>");
                        loopcount++;
                    }
                </script>

	
	
	
	<script>
    var randomScalingFactor = function() {
        return Math.round(Math.random() * 100);
    };

    var dataPrimera = [];
    var colorFondo = [	'rgba(255, 206, 86, 1)',
					'rgba(54, 162, 235, 1)',
					'rgba(255, 99, 132, 1)',
					'rgba(75, 192, 192, 1)',
					'rgba(255, 22, 22, 1)'];
	var colorBorde = [
					'rgba(255, 206, 86, 1)',
					'rgba(54, 162, 235, 1)',
					'rgba(255,99,132, 1)',
					'rgba(75, 192, 192, 1)',
					'rgba(255, 22, 22, 1)',
				];
	var colorFondo2 = 	[
					'rgba(255, 206, 86, 0.40)',
					'rgba(54, 162, 235, 0.40)',
					'rgba(255, 99, 132, 0.40)',
					'rgba(75, 192, 192, 0.40)',
					'rgba(255, 22, 22, 0.40)'];		
	var coloresExtra = [];
	var labelsdin = [];
    for (elementoArray of nandemonaiya[0]) {
    	dataPrimera.push(elementoArray.intencionDeVoto);// statement
    	labelsdin.push("");
    	if (dataPrimera.length > colorFondo.length){
    		var colorRandomizadoSinParametroFinal = 'rgba(' + Math.floor(Math.random() * 255) + ',' + Math.floor(Math.random() * 255) + ',' + Math.floor(Math.random() * 255) + ','
    		var parametroFinal = '1)';
    		var parametroFinalFondo = '0.40)';
    		var randomColor = colorRandomizadoSinParametroFinal + parametroFinal;
    		var randomBackgroundColor = colorRandomizadoSinParametroFinal + parametroFinalFondo;
    		var randomColorBorde = 'rgba(' + Math.floor(Math.random() * 255) + ',' + Math.floor(Math.random() * 255) + ',' + Math.floor(Math.random() * 255) + ',' + 1 + ')';
    		colorFondo.push(randomColor);
    		coloresExtra.push(randomColor);
    		colorBorde.push(randomColorBorde);
    		colorFondo2.push(randomBackgroundColor);
    	}
    }

    //console.log(colorFondo);
    //console.log(dataPrimera);
    var config = {
        type: 'bar',
        data: {
            datasets: [{
                data: dataPrimera
                ,
                backgroundColor: colorFondo,
				 backgroundColor2: colorFondo2,
				borderColor: colorBorde,
            }],
            labels: labelsdin,
        },
        options: {
            responsive: true,
			legend: {
				display: false,
				labels: {
					fontColor: 'rgb(255, 99, 132)',
					
				}
			},
			scales: {
        xAxes: [{
            ticks: {
                fontSize: 12
            }
        }]
    }
        }
    };

    window.onload = function() {
        var ctx = document.getElementById("chart-area").getContext("2d");
        window.myPie = new Chart(ctx, config);
		seleccionarGrafico(0);
		$('.btn-graph')[0];
		$('.btn-graph:first-child').addClass('activo');
		
    };

    $(".btn-graph").click(function(){
		  $('.btn-graph.activo').removeClass('activo');
		 $(this).addClass('activo');
        //var encuestadoraEnArray = this.id;
        ////console.log(encuestadoraEnArray);
		seleccionarGrafico(this.id)
		
    });
	
	var seleccionarGrafico = function(encuestadoraEnArray){
		//('.btn-graph:first-child').addClass('activo');
		var candidatosCambiantes = [];
		for (candidato of nandemonaiya[encuestadoraEnArray]) {
			candidatosCambiantes.push(candidato.intencionDeVoto);// statement
		}

		//console.log(candidatosCambiantes);

        config.data.datasets.forEach(function(dataset) {
            dataset.data = candidatosCambiantes;
        });
        window.myPie.update();
		
		var list = document.getElementById('referencias');

		while (list.hasChildNodes()) {   
			list.removeChild(list.firstChild);
		}
		
		for(var llave in nandemonaiya[encuestadoraEnArray] ){
			config.data.datasets[0].backgroundColor[llave];
			config.data.datasets[0].backgroundColor2[llave];
			var unElemento = nandemonaiya[encuestadoraEnArray][llave];
			var ref = document.querySelector('.referencias');
			var span = document.createElement('span');
			var h2 =  document.querySelector('.tit-cons');
			var li = document.createElement('li');
			ref.appendChild(li);
			li.innerText = unElemento.candidato + " " + unElemento.intencionDeVoto + "%";
			h2.innerText = unElemento.encuestadora;
			li.appendChild(span);
			li.style.backgroundColor = config.data.datasets[0].backgroundColor2[llave];
			span.style.backgroundColor = config.data.datasets[0].backgroundColor[llave];
			
		}
	}


    var colorNames = Object.keys(window.chartColors);
	
	

 </script>
</body>

</html>
